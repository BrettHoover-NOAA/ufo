# This yaml is used to test that differnt variables can be used in the 
# observation processing compared to the h(x) calculation. 

window begin: 2021-05-21T00:00:00Z
window end: 2021-05-21T23:00:00Z

observations:
- obs space:
    name: Surface
    obsdatain:
      obsfile: Data/ufo/testinput_tier_1/PStar_obs_20210521T1200Z.nc4
#   obsdataout:
#     obsfile: Data/PStar_obs_20210521T1200Z_observed_derived_simulated_variables_out.nc4
    observed variables: [station_pressure, mean_sea_level_pressure]
    derived variables: [surface_pressure]
    simulated variables: [surface_pressure]
  geovals:
    filename: Data/ufo/testinput_tier_1/PStar_geovals_20210521T1200Z.nc4
  obs operator:
    name: Identity

  obs filters:
  - filter: Bounds Check
    filter variables:
    - name: mean_sea_level_pressure@ObsValue
    minvalue: 0.00001

  - filter: Bounds Check
    filter variables:
    - name: station_pressure@ObsValue
    minvalue: 0.00001

  - filter: Variable Transforms
    Transform: PStar

  compareVariables:                 # test output matches precalculated values
    - reference:
        name: PStarFlags@TestReference
      test:
        name: PStar@DerivedQCFlags
    - reference:
        name: PStarErr@TestReference
      test:
        name: PStar@DerivedObsError
      absTol: 1.0e-5
    - reference:
        name: PStar_PGE@TestReference
      test:
        name: PStar@DerivedGrossErrorProbability
      absTol: 1.0e-5
    - reference:
        name: PStar@TestReference
      test:
        name: PStar@DerivedObsValue
      relTol: 1.0e-5
